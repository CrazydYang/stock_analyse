import{d as G,a as c,z as J,y as O,c as T,e as t,w as n,i as d,E as V,b as u,l as C,I as q,k as s,J as Q,G as W,H as X,f as Y,C as B,t as f,K as Z,u as ee,o as N,_ as te}from"./index-CMEqQrDU.js";import{g as oe}from"./individualStockApi-Q0WHDfaV.js";const ae={class:"stock-list-view"},ne={class:"header-content"},le={class:"header-actions"},re={class:"search-section"},se={class:"table-container"},ie={class:"pagination-container"},ce=G({__name:"StockListView",setup(de){const y=ee(),g=c(!1),x=c([]),h=c(""),v=c(""),w=c("asc"),p=c(1),k=c(10),S=c(0),I=J(()=>{let e=x.value;return v.value&&(e=[...e].sort((a,_)=>{const i=a[v.value],r=_[v.value];if(typeof i=="string"&&typeof r=="string")return w.value==="asc"?i.localeCompare(r):r.localeCompare(i);{const b=i==null?-1/0:Number(i),l=r==null?-1/0:Number(r);return w.value==="asc"?b-l:l-b}})),e}),m=async()=>{g.value=!0;try{const e=await oe({page:p.value,page_size:k.value,keyword:h.value});x.value=e.data,S.value=e.total,V.success("股票数据加载成功")}catch(e){console.error("获取股票列表失败:",e),V.error("获取股票列表失败，请稍后重试")}finally{g.value=!1}},z=()=>{p.value=1,m()},L=()=>{h.value="",p.value=1,m()},$=({prop:e,order:a})=>{v.value=e||"",w.value=a==="ascending"?"asc":"desc"},D=e=>{k.value=e,p.value=1,m()},E=e=>{p.value=e,m()},M=e=>{y.push(`/stock-realtime/${e}`)},A=e=>{y.push(`/stock-history/${e}`)},F=e=>e==null?"-":e>=1e11?(e/1e11).toFixed(2)+"千亿":e>=1e8?(e/1e8).toFixed(2)+"亿":e>=1e4?(e/1e4).toFixed(2)+"万":e.toString(),H=e=>e==null?"-":e>=1e8?(e/1e8).toFixed(2)+"亿手":e>=1e4?(e/1e4).toFixed(2)+"万手":e.toString()+"手";return O(()=>{m()}),(e,a)=>{const _=d("el-button"),i=d("el-input"),r=d("el-form-item"),b=d("el-form"),l=d("el-table-column"),K=d("el-table"),P=d("el-pagination"),R=d("el-card"),U=X("loading");return N(),T("div",ae,[t(R,{class:"page-header"},{header:n(()=>[u("div",ne,[a[3]||(a[3]=u("h2",null,"股票列表",-1)),u("div",le,[t(_,{type:"primary",icon:C(Z),onClick:m,loading:g.value},{default:n(()=>[...a[2]||(a[2]=[s(" 刷新数据 ",-1)])]),_:1},8,["icon","loading"])])])]),default:n(()=>[u("div",re,[t(b,{inline:!0,class:"search-form"},{default:n(()=>[t(r,{label:"股票代码/名称"},{default:n(()=>[t(i,{modelValue:h.value,"onUpdate:modelValue":a[0]||(a[0]=o=>h.value=o),placeholder:"请输入股票代码或名称",clearable:"",onClear:z},null,8,["modelValue"])]),_:1}),t(r,null,{default:n(()=>[t(_,{type:"primary",icon:C(q),onClick:z},{default:n(()=>[...a[4]||(a[4]=[s("搜索",-1)])]),_:1},8,["icon"]),t(_,{icon:C(Q),onClick:L},{default:n(()=>[...a[5]||(a[5]=[s("重置",-1)])]),_:1},8,["icon"])]),_:1})]),_:1})]),u("div",se,[W((N(),Y(K,{data:I.value,border:"",stripe:"",style:{width:"100%"},onSortChange:$,fit:""},{default:n(()=>[t(l,{prop:"code",label:"股票代码","min-width":"100",sortable:""}),t(l,{prop:"name",label:"股票名称","min-width":"120",sortable:""}),t(l,{prop:"industry",label:"行业","min-width":"120"}),t(l,{prop:"latest_price",label:"最新价","min-width":"100",sortable:""}),t(l,{prop:"change_percent",label:"涨跌幅","min-width":"100",sortable:""},{default:n(o=>[u("span",{class:B(o.row.change_percent>=0?"text-success":"text-danger")},f(o.row.change_percent?o.row.change_percent.toFixed(2)+"%":"-"),3)]),_:1}),t(l,{prop:"change_amount",label:"涨跌额","min-width":"100",sortable:""},{default:n(o=>[u("span",{class:B(o.row.change_amount>=0?"text-success":"text-danger")},f(o.row.change_amount?o.row.change_amount.toFixed(2):"-"),3)]),_:1}),t(l,{prop:"volume",label:"成交量","min-width":"100",sortable:""},{default:n(o=>[s(f(H(o.row.volume)),1)]),_:1}),t(l,{prop:"amount",label:"成交额","min-width":"100",sortable:""},{default:n(o=>[s(f(F(o.row.amount)),1)]),_:1}),t(l,{prop:"turnover_rate",label:"换手率","min-width":"80",sortable:""},{default:n(o=>[s(f(o.row.turnover_rate?o.row.turnover_rate.toFixed(2)+"%":"-"),1)]),_:1}),t(l,{prop:"total_market_cap",label:"总市值","min-width":"100",sortable:""},{default:n(o=>[s(f(F(o.row.total_market_cap)),1)]),_:1}),t(l,{prop:"pe_ratio",label:"市盈率","min-width":"80",sortable:""}),t(l,{prop:"pb_ratio",label:"市净率","min-width":"80",sortable:""}),t(l,{label:"操作","min-width":"180",fixed:"right"},{default:n(o=>[t(_,{type:"primary",size:"small",onClick:j=>M(o.row.code)},{default:n(()=>[...a[6]||(a[6]=[s(" 实时行情 ",-1)])]),_:2},1032,["onClick"]),t(_,{type:"info",size:"small",onClick:j=>A(o.row.code)},{default:n(()=>[...a[7]||(a[7]=[s(" 历史行情 ",-1)])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[U,g.value]])]),u("div",ie,[t(P,{"current-page":p.value,"onUpdate:currentPage":a[1]||(a[1]=o=>p.value=o),"page-size":k.value,total:S.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:D,onCurrentChange:E},null,8,["current-page","page-size","total"])])]),_:1})])}}}),_e=te(ce,[["__scopeId","data-v-7e522ebf"]]);export{_e as default};
