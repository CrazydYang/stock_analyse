import{x as g}from"./index-1owQczTB.js";const l="/django/api/stock";function p(r){if(!r||r.length===0)return{avgChangePercent:0,avgPeRatio:0,avgPbRatio:0,avgChange60Day:0,avgChangeYtd:0};let e=0,a=0,c=0,s=0,t=0,i=0,o=0,u=0,h=0,d=0;return r.forEach(n=>{typeof n.change_percent=="number"&&(e+=n.change_percent,i++),typeof n.pe_ratio=="number"&&n.pe_ratio>0&&(a+=n.pe_ratio,o++),typeof n.pb_ratio=="number"&&n.pb_ratio>0&&(c+=n.pb_ratio,u++),typeof n.change_60day=="number"&&(s+=n.change_60day,h++),typeof n.change_ytd=="number"&&(t+=n.change_ytd,d++)}),{avgChangePercent:i>0?e/i:0,avgPeRatio:o>0?a/o:0,avgPbRatio:u>0?c/u:0,avgChange60Day:h>0?s/h:0,avgChangeYtd:d>0?t/d:0}}async function f(r){try{const e=await g.get(`${l}/industry-sectors/`);if(e.code!==200)throw new Error(e.message||"获取行业板块列表失败");const a=e.data.sectors.find(o=>o.name===r);if(!a)return console.warn(`未找到行业: ${r}`),null;const c=await g.get(`${l}/industry-sector/constituents/${a.code}/`);if(c.code!==200)throw new Error(c.message||"获取行业成分股失败");const s=c.data.constituents;let t=null;try{const o=await g.get(`${l}/industry-sector/realtime/${a.code}/`);o.code===200&&(t=o.data)}catch(o){console.warn(`获取行业 ${a.code} 实时行情失败:`,o)}const i=p(s);return{industry:a.name,code:a.code,count:a.stock_count,stocks:s,...i,latest_price:t?.latest_price||a.latest_price,change_amount:t?.change,change_percent:t?.change_percent||a.change_percent,open:t?.open,high:t?.high,low:t?.low,volume:t?.volume,amount:t?.amount,turnover_rate:t?.turnover_rate,rising_stocks:t?.rising_stocks,falling_stocks:t?.falling_stocks,unchanged_stocks:t?.unchanged_stocks}}catch(e){throw console.error("获取行业详情错误:",e),e}}async function y(r){try{const e=r?{industry:r}:{};return(await g.get(`${l}/industry/statistics/`,{params:e})).data}catch(e){throw console.error("Error fetching industry statistics:",e),e}}export{y as a,f};
