import{d as U,a as h,H as _,y as j,c as p,b as s,g as S,e as n,w as o,i as v,t as l,E as y,G as b,k as G,u as H,o as m,_ as T}from"./index-B66z1j89.js";import{f as q,a as J}from"./industryApi-BSqddLYI.js";const K={class:"industry-analysis"},L={class:"stats-section"},O={class:"stat-number"},Q={class:"stat-number"},W={class:"stat-number"},X={class:"stat-number"},Y={class:"list-section"},Z={class:"list-header"},tt={class:"list-actions"},et={class:"result-count"},at={class:"table-container"},st={class:"industry-info"},nt={class:"industry-name"},ot={class:"rise-fall-count"},lt={class:"rise-count"},rt={class:"fall-count"},it={class:"value-badge"},dt={class:"value-badge"},ct={key:0},ut={key:1},_t={key:0,class:"pagination-container"},vt={key:0,class:"loading-overlay"},gt=U({__name:"IndustryAnalysis",setup(ht){const i=h([]),f=h(!1),k=h(!1),u=h(1),g=h(12),x=H(),w=_(()=>i.value.length),C=_(()=>i.value.reduce((a,t)=>a+t.count,0)),D=_(()=>w.value>0?Math.round(C.value/w.value):0),M=_(()=>i.value.reduce((a,t)=>t.count>a.count?t:a,{industry:"",count:0,stocks:[]})),I=_(()=>Math.ceil(i.value.length/g.value)),N=_(()=>{const a=(u.value-1)*g.value,t=a+g.value;return i.value.slice(a,t)});_(()=>{const a=[],t=Math.max(1,u.value-2),d=Math.min(I.value,u.value+2);for(let r=t;r<=d;r++)a.push(r);return a});const P=async()=>{f.value=!0;try{const a=await q();i.value=a}catch(a){console.error("获取行业数据错误:",a),y.error("获取行业数据失败，请稍后重试")}finally{f.value=!1}},z=a=>{if(a==null)return"0.00%";const t=a.toFixed(2);return a>0?`+${t}%`:`${t}%`},V=a=>{g.value=a,u.value=1},A=a=>{u.value=a},F=async a=>{if(!a.code){y.warning("行业代码不存在，无法获取详情");return}k.value=!0;try{const{stocks:t,stats:d}=await J(a.code),r={...a,stocks:t,...d};x.push({name:"industry-detail",params:{industry:encodeURIComponent(r.industry)},state:{industryData:{...r}}})}catch(t){console.error(`获取行业 ${a.industry} 详情失败:`,t),y.error("获取行业详情失败，请稍后重试"),x.push({name:"industry-detail",params:{industry:encodeURIComponent(a.industry)}})}finally{k.value=!1}};return j(()=>{P()}),(a,t)=>{const d=v("el-card"),r=v("el-col"),$=v("el-row"),c=v("el-table-column"),B=v("el-button"),E=v("el-table"),R=v("el-pagination");return m(),p("div",K,[s("div",L,[n($,{gutter:20,class:"stats-grid"},{default:o(()=>[n(r,{xs:12,sm:6,md:6,lg:6},{default:o(()=>[n(d,{class:"stat-card",shadow:"hover"},{default:o(()=>[s("div",O,l(w.value),1),t[1]||(t[1]=s("div",{class:"stat-label"},"行业总数",-1))]),_:1})]),_:1}),n(r,{xs:12,sm:6,md:6,lg:6},{default:o(()=>[n(d,{class:"stat-card",shadow:"hover"},{default:o(()=>[s("div",Q,l(C.value),1),t[2]||(t[2]=s("div",{class:"stat-label"},"股票总数",-1))]),_:1})]),_:1}),n(r,{xs:12,sm:6,md:6,lg:6},{default:o(()=>[n(d,{class:"stat-card",shadow:"hover"},{default:o(()=>[s("div",W,l(D.value),1),t[3]||(t[3]=s("div",{class:"stat-label"},"平均行业股票数",-1))]),_:1})]),_:1}),n(r,{xs:12,sm:6,md:6,lg:6},{default:o(()=>[n(d,{class:"stat-card",shadow:"hover"},{default:o(()=>[s("div",X,l(M.value?.count||0),1),t[4]||(t[4]=s("div",{class:"stat-label"},"最大行业股票数",-1))]),_:1})]),_:1})]),_:1})]),s("div",Y,[s("div",Z,[t[5]||(t[5]=s("h2",null,"行业分类详情",-1)),s("div",tt,[s("span",et," 共找到 "+l(i.value.length)+" 个行业 ",1)])]),s("div",at,[n(E,{data:N.value,style:{width:"100%"},stripe:"",border:"",loading:f.value,"empty-text":"暂无行业数据"},{default:o(()=>[n(c,{prop:"industry",label:"行业名称",width:"120"},{default:o(e=>[s("div",st,[s("span",nt,l(e.row.industry),1)])]),_:1}),n(c,{prop:"change_amount",label:"涨跌额",width:"120",align:"center",sortable:""},{default:o(e=>[s("span",{class:b(["change-value",{positive:e.row.change_amount>0,negative:e.row.change_amount<0,neutral:e.row.change_amount===0}])},l(e.row.change_amount?e.row.change_amount.toFixed(2):"0.00"),3)]),_:1}),n(c,{prop:"change_percent",label:"行业平均涨跌幅",width:"150",align:"center",sortable:""},{default:o(e=>[s("span",{class:b(["change-value",{positive:e.row.change_percent>0,negative:e.row.change_percent<0,neutral:e.row.change_percent===0}])},l(z(e.row.change_percent)),3)]),_:1}),n(c,{prop:"rise_fall_count",label:"上涨/下跌家数",width:"120",align:"center"},{default:o(e=>[s("div",ot,[s("span",lt,l(e.row.rise_count||0),1),t[6]||(t[6]=s("span",{class:"count-separator"},"/",-1)),s("span",rt,l(e.row.fall_count||0),1)])]),_:1}),n(c,{prop:"total_market_value",label:"总市值(亿)",width:"120",align:"center"},{default:o(e=>[s("span",it,l(e.row.total_market_value?(e.row.total_market_value/1e8).toFixed(2):"N/A"),1)]),_:1}),n(c,{prop:"turnover_rate",label:"换手率",width:"100",align:"center"},{default:o(e=>[s("span",dt,l(e.row.turnover_rate?e.row.turnover_rate.toFixed(2)+"%":"N/A"),1)]),_:1}),n(c,{prop:"leading_stock",label:"领涨股",width:"120",align:"center"},{default:o(e=>[e.row.leading_stock?(m(),p("div",ct,[s("div",null,l(e.row.leading_stock),1),s("div",{class:b(["change-value",{positive:e.row.leading_stock_change_percent>0,negative:e.row.leading_stock_change_percent<0,neutral:e.row.leading_stock_change_percent===0}])},l(z(e.row.leading_stock_change_percent)),3)])):(m(),p("span",ut,"--"))]),_:1}),n(c,{label:"操作",width:"120",align:"center",fixed:"right"},{default:o(e=>[n(B,{type:"primary",size:"small",onClick:pt=>F(e.row)},{default:o(()=>[...t[7]||(t[7]=[G(" 查看详情 ",-1)])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","loading"])]),I.value>1?(m(),p("div",_t,[n(R,{"current-page":u.value,"onUpdate:currentPage":t[0]||(t[0]=e=>u.value=e),"page-size":g.value,total:i.value.length,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:V,onCurrentChange:A},null,8,["current-page","page-size","total"])])):S("",!0)]),f.value?(m(),p("div",vt,[...t[8]||(t[8]=[s("div",{class:"loading-spinner"},null,-1),s("div",{class:"loading-text"},"正在加载行业数据...",-1)])])):S("",!0)])}}}),wt=T(gt,[["__scopeId","data-v-a12103e8"]]);export{wt as default};
