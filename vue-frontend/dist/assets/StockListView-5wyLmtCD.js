import{d as j,a as i,z as G,y as J,c as O,e as t,w as n,i as c,E as F,b as d,l as y,I as R,k as u,J as T,G as q,H as Q,f as W,C as V,t as f,K as X,u as Y,o as B,_ as Z}from"./index-BgrsVbnu.js";import{g as ee}from"./individualStockApi-C2WVpK4h.js";const te={class:"stock-list-view"},oe={class:"header-content"},ae={class:"header-actions"},ne={class:"search-section"},le={class:"table-container"},re={class:"pagination-container"},se=j({__name:"StockListView",setup(ie){const N=Y(),g=i(!1),C=i([]),h=i(""),v=i(""),w=i("asc"),p=i(1),k=i(10),x=i(0),I=G(()=>{let e=C.value;return v.value&&(e=[...e].sort((a,m)=>{const s=a[v.value],r=m[v.value];if(typeof s=="string"&&typeof r=="string")return w.value==="asc"?s.localeCompare(r):r.localeCompare(s);{const b=s==null?-1/0:Number(s),l=r==null?-1/0:Number(r);return w.value==="asc"?b-l:l-b}})),e}),_=async()=>{g.value=!0;try{const e=await ee({page:p.value,page_size:k.value,keyword:h.value});C.value=e.data,x.value=e.total,F.success("股票数据加载成功")}catch(e){console.error("获取股票列表失败:",e),F.error("获取股票列表失败，请稍后重试")}finally{g.value=!1}},S=()=>{p.value=1,_()},L=()=>{h.value="",p.value=1,_()},D=({prop:e,order:a})=>{v.value=e||"",w.value=a==="ascending"?"asc":"desc"},E=e=>{k.value=e,p.value=1,_()},M=e=>{p.value=e,_()},A=e=>{N.push(`/stock-history/${e}`)},z=e=>e==null?"-":e>=1e11?(e/1e11).toFixed(2)+"千亿":e>=1e8?(e/1e8).toFixed(2)+"亿":e>=1e4?(e/1e4).toFixed(2)+"万":e.toString(),H=e=>e==null?"-":e>=1e8?(e/1e8).toFixed(2)+"亿手":e>=1e4?(e/1e4).toFixed(2)+"万手":e.toString()+"手";return J(()=>{_()}),(e,a)=>{const m=c("el-button"),s=c("el-input"),r=c("el-form-item"),b=c("el-form"),l=c("el-table-column"),K=c("el-table"),P=c("el-pagination"),U=c("el-card"),$=Q("loading");return B(),O("div",te,[t(U,{class:"page-header"},{header:n(()=>[d("div",oe,[a[3]||(a[3]=d("h2",null,"股票列表",-1)),d("div",ae,[t(m,{type:"primary",icon:y(X),onClick:_,loading:g.value},{default:n(()=>[...a[2]||(a[2]=[u(" 刷新数据 ",-1)])]),_:1},8,["icon","loading"])])])]),default:n(()=>[d("div",ne,[t(b,{inline:!0,class:"search-form"},{default:n(()=>[t(r,{label:"股票代码/名称"},{default:n(()=>[t(s,{modelValue:h.value,"onUpdate:modelValue":a[0]||(a[0]=o=>h.value=o),placeholder:"请输入股票代码或名称",clearable:"",onClear:S},null,8,["modelValue"])]),_:1}),t(r,null,{default:n(()=>[t(m,{type:"primary",icon:y(R),onClick:S},{default:n(()=>[...a[4]||(a[4]=[u("搜索",-1)])]),_:1},8,["icon"]),t(m,{icon:y(T),onClick:L},{default:n(()=>[...a[5]||(a[5]=[u("重置",-1)])]),_:1},8,["icon"])]),_:1})]),_:1})]),d("div",le,[q((B(),W(K,{data:I.value,border:"",stripe:"",style:{width:"100%"},onSortChange:D,fit:""},{default:n(()=>[t(l,{prop:"code",label:"股票代码","min-width":"100",sortable:""}),t(l,{prop:"name",label:"股票名称","min-width":"120",sortable:""}),t(l,{prop:"industry",label:"行业","min-width":"120"}),t(l,{prop:"latest_price",label:"最新价","min-width":"100",sortable:""}),t(l,{prop:"change_percent",label:"涨跌幅","min-width":"100",sortable:""},{default:n(o=>[d("span",{class:V(o.row.change_percent>=0?"text-success":"text-danger")},f(o.row.change_percent?o.row.change_percent.toFixed(2)+"%":"-"),3)]),_:1}),t(l,{prop:"change_amount",label:"涨跌额","min-width":"100",sortable:""},{default:n(o=>[d("span",{class:V(o.row.change_amount>=0?"text-success":"text-danger")},f(o.row.change_amount?o.row.change_amount.toFixed(2):"-"),3)]),_:1}),t(l,{prop:"volume",label:"成交量","min-width":"100",sortable:""},{default:n(o=>[u(f(H(o.row.volume)),1)]),_:1}),t(l,{prop:"amount",label:"成交额","min-width":"100",sortable:""},{default:n(o=>[u(f(z(o.row.amount)),1)]),_:1}),t(l,{prop:"turnover_rate",label:"换手率","min-width":"80",sortable:""},{default:n(o=>[u(f(o.row.turnover_rate?o.row.turnover_rate.toFixed(2)+"%":"-"),1)]),_:1}),t(l,{prop:"total_market_cap",label:"总市值","min-width":"100",sortable:""},{default:n(o=>[u(f(z(o.row.total_market_cap)),1)]),_:1}),t(l,{prop:"pe_ratio",label:"市盈率","min-width":"80",sortable:""}),t(l,{prop:"pb_ratio",label:"市净率","min-width":"80",sortable:""}),t(l,{label:"操作","min-width":"180",fixed:"right"},{default:n(o=>[t(m,{type:"primary",size:"small",onClick:ce=>A(o.row.code)},{default:n(()=>[...a[6]||(a[6]=[u(" 股票详情 ",-1)])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[$,g.value]])]),d("div",re,[t(P,{"current-page":p.value,"onUpdate:currentPage":a[1]||(a[1]=o=>p.value=o),"page-size":k.value,total:x.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:E,onCurrentChange:M},null,8,["current-page","page-size","total"])])]),_:1})])}}}),pe=Z(se,[["__scopeId","data-v-9596319b"]]);export{pe as default};
