import{d as te,a as u,H as ne,y as ae,J as oe,K as le,c as P,b as l,g as D,f as S,e as a,w as o,i as r,E as R,l as g,N as se,k as C,t as d,W as z,F as N,D as re,G as B,X as ie,Y as ce,Z as ue,o as c,_ as de}from"./index-B66z1j89.js";import{g as F}from"./strategyApi-wPfGHHLp.js";const _e={class:"index-rps-view","element-loading-text":"正在加载指数RPS数据..."},pe={class:"page-header"},fe={class:"header-content"},ge={class:"header-actions"},ve={key:0,class:"rps-data-section"},he={class:"table-header"},me={class:"table-controls"},we={class:"custom-header"},ye={class:"custom-header"},Se={class:"change-percent-cell"},Re={class:"trend-indicator"},xe={class:"custom-header"},be={class:"rps-cell"},ke={class:"table-footer"},Pe=te({__name:"IndexRpsView",setup(Ce){const v=u(!1),x=u(!1),_=u([]),V=u(""),b=u(""),p=u(["5","20","60"]),m=u(1),w=u(20),T=ne(()=>{let e=_.value;b.value&&(e=e.filter(f=>f.指数简称.includes(b.value)));const n=(m.value-1)*w.value,i=n+w.value;return e.slice(n,i)}),E=()=>p.value.length>0?`RPS_${p.value[0]}`:"",U=e=>e>=90?"#f56c6c":e>=80?"#e6a23c":e>=70?"#67c23a":"#909399",j=e=>e>=90?"极强":e>=80?"强势":e>=70?"良好":e>=50?"一般":"弱势",q=e=>e>=90?"rank-excellent":e>=80?"rank-strong":e>=70?"rank-good":e>=50?"rank-normal":"rank-weak",K=({row:e})=>{if(p.value.length>0){const n=e[`RPS_${p.value[0]}`];if(n>=90)return"row-excellent";if(n>=80)return"row-strong";if(n>=70)return"row-good"}return""},L=e=>{e.prop&&e.order&&_.value.sort((n,i)=>{const f=n[e.prop],k=i[e.prop];return e.order==="ascending"?f-k:k-f})},M=e=>{w.value=e,m.value=1},A=e=>{m.value=e},G=e=>{R({message:`${e.指数简称} (${e.指数代码})`,type:"info"})},H=e=>e?new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"",I=async()=>{if(!v.value){v.value=!0;try{const e=p.value.join(","),n=await F(e);_.value=n.data,V.value=n.query_time,R.success("RPS数据加载成功")}catch(e){console.error("加载RPS数据失败:",e),R.error("加载RPS数据失败，请稍后重试")}finally{v.value=!1}}},J=async()=>{if(!x.value){x.value=!0;try{const e=p.value.join(","),i=(await F(e,!0)).saved_count;R.success(`成功保存${i}条RPS数据到数据库`)}catch(e){console.error("保存RPS数据失败:",e),R.error("保存RPS数据失败，请稍后重试")}finally{x.value=!1}}};return ae(()=>{I()}),(e,n)=>{const i=r("el-button"),f=r("el-card"),k=r("el-input"),y=r("el-table-column"),W=r("el-tag"),h=r("el-icon"),$=r("el-tooltip"),X=r("el-progress"),Y=r("el-table"),Z=r("el-pagination"),O=r("el-empty"),Q=le("loading");return oe((c(),P("div",_e,[l("div",pe,[a(f,{shadow:"hover"},{default:o(()=>[l("div",fe,[n[5]||(n[5]=l("div",{class:"strategy-info"},[l("h1",{class:"strategy-title"},"指数RPS强度排名"),l("p",{class:"strategy-subtitle"},"板块轮动与强势指数分析")],-1)),l("div",ge,[a(i,{onClick:I,loading:v.value,icon:g(se),type:"primary"},{default:o(()=>[...n[3]||(n[3]=[C("刷新数据",-1)])]),_:1},8,["loading","icon"]),a(i,{onClick:J,loading:x.value,type:"success"},{default:o(()=>[...n[4]||(n[4]=[C("保存数据",-1)])]),_:1},8,["loading"])])])]),_:1})]),_.value.length>0?(c(),P("div",ve,[a(f,{shadow:"hover"},{header:o(()=>[l("div",he,[l("h3",null,"指数RPS强度排名 ("+d(H(V.value))+")",1),l("div",me,[a(k,{modelValue:b.value,"onUpdate:modelValue":n[0]||(n[0]=t=>b.value=t),placeholder:"搜索指数名称","prefix-icon":"Search",clearable:"",style:{width:"200px"}},null,8,["modelValue"])])])]),default:o(()=>[a(Y,{data:T.value,stripe:"",border:"",style:{width:"100%"},"default-sort":{prop:E(),order:"descending"},height:"600","row-class-name":K,"highlight-current-row":"",onSortChange:L},{default:o(()=>[a(y,{type:"index",label:"#",width:"50",fixed:"left",align:"center"}),a(y,{prop:"指数代码",label:"指数代码",width:"100",sortable:"custom",fixed:"left",align:"center"},{default:o(t=>[a(W,{size:"small",effect:"plain"},{default:o(()=>[C(d(t.row.指数代码),1)]),_:2},1024)]),_:1}),a(y,{prop:"指数简称",label:"指数简称",width:"120",sortable:"custom",fixed:"left"},{header:o(()=>[l("div",we,[n[6]||(n[6]=l("span",null,"指数简称",-1)),a($,{content:"点击指数名称可查看详情",placement:"top"},{default:o(()=>[a(h,null,{default:o(()=>[a(g(z))]),_:1})]),_:1})])]),default:o(t=>[a(i,{type:"text",onClick:s=>G(t.row)},{default:o(()=>[C(d(t.row.指数简称),1)]),_:2},1032,["onClick"])]),_:1}),(c(!0),P(N,null,re(p.value,t=>(c(),P(N,{key:t},[a(y,{label:`${t}日涨跌幅`,width:"120",sortable:"custom",prop:`${t}日涨跌幅`,align:"center"},{header:o(()=>[l("div",ye,[l("span",null,d(t)+"日涨跌幅",1),a($,{content:`${t}日内的价格变化百分比`,placement:"top"},{default:o(()=>[a(h,null,{default:o(()=>[a(g(z))]),_:1})]),_:2},1032,["content"])])]),default:o(s=>[l("div",Se,[l("span",{class:B({up:s.row[`${t}日涨跌幅`]>0,down:s.row[`${t}日涨跌幅`]<0})},d(s.row[`${t}日涨跌幅`]>0?"+":"")+d(s.row[`${t}日涨跌幅`].toFixed(2))+"% ",3),l("div",Re,[s.row[`${t}日涨跌幅`]>0?(c(),S(h,{key:0},{default:o(()=>[a(g(ie))]),_:1})):s.row[`${t}日涨跌幅`]<0?(c(),S(h,{key:1},{default:o(()=>[a(g(ce))]),_:1})):(c(),S(h,{key:2},{default:o(()=>[a(g(ue))]),_:1}))])])]),_:2},1032,["label","prop"]),a(y,{label:`RPS_${t}`,width:"170",sortable:"custom",prop:`RPS_${t}`,align:"center"},{header:o(()=>[l("div",xe,[l("span",null,"RPS_"+d(t),1),a($,{content:"相对强度指标，值越高表示相对强度越强",placement:"top"},{default:o(()=>[a(h,null,{default:o(()=>[a(g(z))]),_:1})]),_:1})])]),default:o(s=>[l("div",be,[a(X,{percentage:s.row[`RPS_${t}`],color:U(s.row[`RPS_${t}`]),format:ee=>ee.toFixed(1),"stroke-width":18,"text-inside":!0,"show-text":!0},null,8,["percentage","color","format"]),l("div",{class:B(["rps-rank",q(s.row[`RPS_${t}`])])},d(j(s.row[`RPS_${t}`])),3)])]),_:2},1032,["label","prop"])],64))),128))]),_:1},8,["data","default-sort"]),l("div",ke,[_.value.length>10?(c(),S(Z,{key:0,layout:"total, sizes, prev, pager, next",total:_.value.length,"page-sizes":[10,20,50,100],"page-size":w.value,"onUpdate:pageSize":n[1]||(n[1]=t=>w.value=t),"current-page":m.value,"onUpdate:currentPage":n[2]||(n[2]=t=>m.value=t),onSizeChange:M,onCurrentChange:A},null,8,["total","page-size","current-page"])):D("",!0)])]),_:1})])):D("",!0),!v.value&&_.value.length===0?(c(),S(O,{key:1,description:"暂无RPS数据"})):D("",!0)])),[[Q,v.value]])}}}),ze=de(Pe,[["__scopeId","data-v-f9234315"]]);export{ze as default};
