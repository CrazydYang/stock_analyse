import{d as U,a as c,B as j,C as J,c as O,e as o,w as a,i as d,E as z,b as _,l as C,J as T,k as p,K as q,H as G,I as Q,f as W,t as L,L as X,u as Y,o as V,_ as Z}from"./index-BBEcv-Cz.js";import{g as ee}from"./individualStockApi-DTthTEbA.js";const te={class:"stock-list-view"},oe={class:"header-content"},ae={class:"header-actions"},le={class:"search-section"},ne={class:"table-container"},se={class:"pagination-container"},re=U({__name:"StockListView",setup(ie){const y=Y(),f=c(!1),k=c([]),m=c(""),v=c(""),b=c("asc"),u=c(1),w=c(10),S=c(0),B=j(()=>{let e=k.value;if(m.value){const t=m.value.toLowerCase();e=e.filter(s=>s.code.toLowerCase().includes(t)||s.name.toLowerCase().includes(t))}return v.value&&(e=[...e].sort((t,s)=>{const i=t[v.value],r=s[v.value];if(typeof i=="string"&&typeof r=="string")return b.value==="asc"?i.localeCompare(r):r.localeCompare(i);{const h=i==null?-1/0:Number(i),l=r==null?-1/0:Number(r);return b.value==="asc"?h-l:l-h}})),e}),g=async()=>{f.value=!0;try{const e=await ee({page:u.value,page_size:w.value});k.value=e.data,S.value=e.total,z.success("股票数据加载成功")}catch(e){console.error("获取股票列表失败:",e),z.error("获取股票列表失败，请稍后重试")}finally{f.value=!1}},x=()=>{u.value=1},F=()=>{m.value="",u.value=1},N=({prop:e,order:t})=>{v.value=e||"",b.value=t==="ascending"?"asc":"desc"},I=e=>{w.value=e,u.value=1,g()},$=e=>{u.value=e,g()},D=e=>{y.push(`/stock-realtime/${e}`)},E=e=>{y.push(`/stock-history/${e}`)},M=e=>e==null?"-":e>=1e11?(e/1e11).toFixed(2)+"千亿":e>=1e8?(e/1e8).toFixed(2)+"亿":e>=1e4?(e/1e4).toFixed(2)+"万":e.toString();return J(()=>{g()}),(e,t)=>{const s=d("el-button"),i=d("el-input"),r=d("el-form-item"),h=d("el-form"),l=d("el-table-column"),A=d("el-table"),H=d("el-pagination"),K=d("el-card"),P=Q("loading");return V(),O("div",te,[o(K,{class:"page-header"},{header:a(()=>[_("div",oe,[t[3]||(t[3]=_("h2",null,"股票列表",-1)),_("div",ae,[o(s,{type:"primary",icon:C(X),onClick:g,loading:f.value},{default:a(()=>[...t[2]||(t[2]=[p(" 刷新数据 ",-1)])]),_:1},8,["icon","loading"])])])]),default:a(()=>[_("div",le,[o(h,{inline:!0,class:"search-form"},{default:a(()=>[o(r,{label:"股票代码/名称"},{default:a(()=>[o(i,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=n=>m.value=n),placeholder:"请输入股票代码或名称",clearable:"",onClear:x},null,8,["modelValue"])]),_:1}),o(r,null,{default:a(()=>[o(s,{type:"primary",icon:C(T),onClick:x},{default:a(()=>[...t[4]||(t[4]=[p("搜索",-1)])]),_:1},8,["icon"]),o(s,{icon:C(q),onClick:F},{default:a(()=>[...t[5]||(t[5]=[p("重置",-1)])]),_:1},8,["icon"])]),_:1})]),_:1})]),_("div",ne,[G((V(),W(A,{data:B.value,border:"",stripe:"",style:{width:"100%"},onSortChange:N,fit:""},{default:a(()=>[o(l,{prop:"code",label:"股票代码","min-width":"100",sortable:""}),o(l,{prop:"name",label:"股票名称","min-width":"120",sortable:""}),o(l,{prop:"exchange",label:"交易所","min-width":"80"}),o(l,{prop:"industry",label:"行业","min-width":"120"}),o(l,{prop:"market_cap",label:"市值","min-width":"100",sortable:""},{default:a(n=>[p(L(M(n.row.market_cap)),1)]),_:1}),o(l,{prop:"pe_ratio",label:"市盈率","min-width":"80",sortable:""}),o(l,{prop:"pb_ratio",label:"市净率","min-width":"80",sortable:""}),o(l,{prop:"dividend_yield",label:"股息率","min-width":"80",sortable:""},{default:a(n=>[p(L(n.row.dividend_yield?n.row.dividend_yield.toFixed(2)+"%":"-"),1)]),_:1}),o(l,{prop:"listing_date",label:"上市日期","min-width":"100",sortable:""}),o(l,{label:"操作","min-width":"180",fixed:"right"},{default:a(n=>[o(s,{type:"primary",size:"small",onClick:R=>D(n.row.code)},{default:a(()=>[...t[6]||(t[6]=[p(" 实时行情 ",-1)])]),_:2},1032,["onClick"]),o(s,{type:"info",size:"small",onClick:R=>E(n.row.code)},{default:a(()=>[...t[7]||(t[7]=[p(" 历史行情 ",-1)])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[P,f.value]])]),_("div",se,[o(H,{"current-page":u.value,"onUpdate:currentPage":t[1]||(t[1]=n=>u.value=n),"page-size":w.value,total:S.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:I,onCurrentChange:$},null,8,["current-page","page-size","total"])])]),_:1})])}}}),ue=Z(re,[["__scopeId","data-v-0b460ccc"]]);export{ue as default};
